<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 14">
<meta name=Originator content="Microsoft Word 14">
<link rel=File-List href="ExcelBFF_files/filelist.xml">
<link rel=Edit-Time-Data href="ExcelBFF_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Leith McCombs</o:Author>
  <o:LastAuthor>Leith McCombs</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>17</o:TotalTime>
  <o:Created>2012-07-13T00:22:00Z</o:Created>
  <o:LastSaved>2012-07-13T00:22:00Z</o:LastSaved>
  <o:Pages>8</o:Pages>
  <o:Words>4496</o:Words>
  <o:Characters>25633</o:Characters>
  <o:Company>Microsoft Corporation</o:Company>
  <o:Lines>213</o:Lines>
  <o:Paragraphs>60</o:Paragraphs>
  <o:CharactersWithSpaces>30069</o:CharactersWithSpaces>
  <o:Version>14.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="ExcelBFF_files/themedata.thmx">
<link rel=colorSchemeMapping href="ExcelBFF_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>80</w:Zoom>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="267">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520092929 1073786111 9 0 415 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520081665 -1073717157 41 0 66047 0;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520084737 -1073683329 41 0 479 0;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-520092929 1073806591 9 0 415 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 1 Char";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:21.0pt;
	font-family:"Segoe UI","sans-serif";
	mso-fareast-font-family:"Times New Roman";
	color:#3F529C;
	font-weight:bold;}
h3
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 3 Char";
	mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:"Segoe UI","sans-serif";
	mso-fareast-font-family:"Times New Roman";
	color:#3F529C;
	font-weight:bold;}
h4
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 4 Char";
	mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Segoe UI","sans-serif";
	mso-fareast-font-family:"Times New Roman";
	color:#3F529C;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:#1364C4;
	mso-text-animation:none;
	text-decoration:none;
	text-underline:none;
	text-decoration:none;
	text-line-through:none;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:purple;
	mso-themecolor:followedhyperlink;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:21.0pt;
	mso-bidi-font-size:21.0pt;
	font-family:"Segoe UI","sans-serif";
	mso-ascii-font-family:"Segoe UI";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Segoe UI";
	mso-bidi-font-family:"Segoe UI";
	color:#3F529C;
	mso-font-kerning:18.0pt;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	mso-ansi-font-size:13.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:"Segoe UI","sans-serif";
	mso-ascii-font-family:"Segoe UI";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Segoe UI";
	mso-bidi-font-family:"Segoe UI";
	color:#3F529C;
	font-weight:bold;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 4";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Segoe UI","sans-serif";
	mso-ascii-font-family:"Segoe UI";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Segoe UI";
	mso-bidi-font-family:"Segoe UI";
	color:#3F529C;
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Balloon Text";
	mso-ansi-font-size:8.0pt;
	mso-bidi-font-size:8.0pt;
	font-family:"Tahoma","sans-serif";
	mso-ascii-font-family:Tahoma;
	mso-hansi-font-family:Tahoma;
	mso-bidi-font-family:Tahoma;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:10.0pt;
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 @list l0
	{mso-list-id:690646460;
	mso-list-template-ids:962096562;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1
	{mso-list-id:1159688629;
	mso-list-template-ids:-234065830;}
@list l1:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2
	{mso-list-id:1612203149;
	mso-list-template-ids:1331096150;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3
	{mso-list-id:1726417035;
	mso-list-template-ids:-909743184;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4
	{mso-list-id:1870871409;
	mso-list-template-ids:383697368;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level2
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link="#1364C4" vlink=purple style='tab-interval:.5in'>

<div class=WordSection1>

<p class=MsoNormal style='margin-bottom:7.5pt;line-height:normal;mso-outline-level:
1'><b><span style='font-size:17.0pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:#3F529C;mso-font-kerning:18.0pt'>Understanding
the Excel .xls Binary File Format<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><b><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:#5D5D5D'>Office 2010</span></b><span
style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";mso-fareast-font-family:
"Times New Roman";color:#5D5D5D'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><b><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Summary:</span></b><span
style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";mso-fareast-font-family:
"Times New Roman";color:black'> Learn about the MS-XLS binary file format that
is used in previously released Microsoft Excel products. Included in this article
are the basic structures and key concepts for interacting with this file format
programmatically.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><b><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Applies to:</span></b><span
style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";mso-fareast-font-family:
"Times New Roman";color:black'> Microsoft Office Excel 2003 | Microsoft Excel
2002 | Microsoft Excel 2000 | Microsoft Excel 97 <o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><b><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Published:</span></b><span
style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";mso-fareast-font-family:
"Times New Roman";color:black'> February 2011 | <b>Provided by:</b> Microsoft
Corporation<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><b><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Contents</span></b><span
style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";mso-fareast-font-family:
"Times New Roman";color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l3 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615597.aspx#UnderstandMS_XLS_Overview"><span
style='font-family:"Times New Roman","serif"'>Overview of the MS-XLS Binary
File Format</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l3 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615597.aspx#UnderstandMS_XLS_KeyComponents"><span
style='font-family:"Times New Roman","serif"'>Key Components of the MS-XLS File
Format</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l3 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615597.aspx#UnderstandMS_XLS_ExtractData"><span
style='font-family:"Times New Roman","serif"'>Extracting Data from Excel Files</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l3 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615597.aspx#UnderstandMS_XLS_Conclusion"><span
style='font-family:"Times New Roman","serif"'>Conclusion</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l3 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615597.aspx#UnderstandMS_XLS_AdditionalResouces"><span
style='font-family:"Times New Roman","serif"'>Additional Resources</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>This article describes
the structures and some procedures for working with MS-XLS files. It is the
part of a series of articles that introduce the binary file formats used by
Microsoft Office products. These articles are designed to be used in
conjunction with the <a
href="http://msdn.microsoft.com/en-us/library/cc313105.aspx"><span
style='font-family:"Times New Roman","serif"'>Microsoft Office File Format
Documents</span></a> available on MSDN.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l2 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg985447.aspx"><span
style='font-family:"Times New Roman","serif"'>Understanding Graphics in Office
Binary File Formats</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l2 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615407.aspx"><span
style='font-family:"Times New Roman","serif"'>Understanding Office Binary File
Formats</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l2 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615595.aspx"><span
style='font-family:"Times New Roman","serif"'>Understanding the Outlook MS-PST
Binary File Format</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l2 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615594.aspx"><span
style='font-family:"Times New Roman","serif"'>Understanding the PowerPoint
MS-PPT Binary File Format</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l2 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615596.aspx"><span
style='font-family:"Times New Roman","serif"'>Understanding the Word .doc
Binary File Format</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-outline-level:1'><b><span style='font-size:17.0pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:#3F529C;mso-font-kerning:18.0pt'>Overview
of the MS-XLS Binary File Format<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>The <a
href="http://msdn.microsoft.com/en-us/library/cc313154.aspx"><span
style='font-family:"Times New Roman","serif"'>[MS-XLS]: Excel Binary File
Format (.xls) Structure Specification</span></a> is used by Microsoft Office
Excel 2003, Microsoft Excel 2002, Microsoft Excel 2000, and Microsoft Excel 97.
The format is organized into streams and substreams. Each spreadsheet worksheet
is stored in its own substream. All of the data is contained in records that
have headers, which give the record type and length. Cell records, which
contain the actual cell data as well as formulas and cell properties, reside in
the cell table. String values are not stored in the cell record, but in a
shared strings table, which the cell record references. Row records contain
property information for row and cell locations. Only cells that contain data
or individual formatting are stored in the substream. The format complies with
the <a href="http://msdn.microsoft.com/en-us/library/dd942138(v=prot.13)">Compound
File Binary File Format</a>, as defined in <a
href="http://msdn.microsoft.com/en-us/library/dd942138(v=prot.13)">[MS-CFB].</a><o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Microsoft Office Excel
2007 uses the <a href="http://msdn.microsoft.com/en-us/library/cc313133.aspx"><span
style='font-family:"Times New Roman","serif"'>[MS-XLSB]: Excel Binary File
Format (.xlsb) Structure Specification</span></a>. This format is similar to
MS-XLS but is not explicitly discussed in this article.<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid #BBBBBB .25pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:15.75pt'>
  <td valign=top style='border:solid #BBBBBB 1.0pt;mso-border-alt:solid #BBBBBB .25pt;
  background:#FCFEC5;padding:7.5pt 8.25pt .75pt 8.25pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><b style='mso-bidi-font-weight:normal'><span style='font-size:10.5pt;
  font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
  color:black;mso-no-proof:yes'><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
   coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
   filled="f" stroked="f">
   <v:stroke joinstyle="miter"/>
   <v:formulas>
    <v:f eqn="if lineDrawn pixelLineWidth 0"/>
    <v:f eqn="sum @0 1 0"/>
    <v:f eqn="sum 0 0 @1"/>
    <v:f eqn="prod @2 1 2"/>
    <v:f eqn="prod @3 21600 pixelWidth"/>
    <v:f eqn="prod @3 21600 pixelHeight"/>
    <v:f eqn="sum @0 0 1"/>
    <v:f eqn="prod @6 1 2"/>
    <v:f eqn="prod @7 21600 pixelWidth"/>
    <v:f eqn="sum @8 21600 0"/>
    <v:f eqn="prod @7 21600 pixelHeight"/>
    <v:f eqn="sum @10 21600 0"/>
   </v:formulas>
   <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
   <o:lock v:ext="edit" aspectratio="t"/>
  </v:shapetype><v:shape id="Picture_x0020_3" o:spid="_x0000_i1027" type="#_x0000_t75"
   alt="Description: Description: note" style='width:.75pt;height:.75pt;
   visibility:visible;mso-wrap-style:square'>
   <v:imagedata src="ExcelBFF_files/image001.gif" o:title=" note"/>
  </v:shape><![endif]--><![if !vml]><img border=0 width=1 height=1
  src="ExcelBFF_files/image001.gif" alt="Description: Description: note"
  v:shapes="Picture_x0020_3"><![endif]></span></b><b><span style='font-size:
  10.5pt;font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
  color:black'>Note: <o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td valign=top style='border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:
  solid #BBBBBB .25pt;mso-border-alt:solid #BBBBBB .25pt;background:#FCFEC5;
  padding:.75pt 8.25pt 7.5pt 8.25pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:
  0in;margin-left:.75pt;margin-bottom:.0001pt;line-height:140%'><span
  style='font-size:9.5pt;line-height:140%;font-family:"Segoe UI","sans-serif";
  mso-fareast-font-family:"Times New Roman";color:black'>The recommended way to
  perform most programming tasks in Microsoft Excel is to use the <a
  href="http://msdn.microsoft.com/en-us/library/ff597926.aspx"><span
  style='font-family:"Times New Roman","serif"'>Excel Primary Interop
  Assemblies</span></a>. These are a set of .NET classes that provide a
  complete object model for working with Microsoft Excel. This article series
  deals only with advanced scenarios, such as where Microsoft Excel is not
  installed on the client.<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
5.25pt;margin-left:0in;line-height:normal;mso-outline-level:4'><b><span
style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";mso-fareast-font-family:
"Times New Roman";color:#3F529C'>Key Components of the MS-XLS File Format<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>The MS-XLS file format
contains streams, substreams, and <a
href="http://msdn.microsoft.com/en-us/library/dd943823.aspx"><span
style='font-family:"Times New Roman","serif"'>records</span></a>. All the
records in an MS-XLS document start with a 2-byte unsigned integer to specify
Record Type (rt), and another for Count of Bytes (cb). Records may be read or
skipped by reading these values, then either reading or skipping the number of
bytes specified by cb, depending on the record type specified by rt. <o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>A record cannot exceed 8224
bytes. If the data the record applies to is larger than that, the rest is
stored in one or more <a
href="http://msdn.microsoft.com/en-us/library/dd949081.aspx"><span
style='font-family:"Times New Roman","serif"'>continue records</span></a>.<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid #BBBBBB .25pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:15.75pt'>
  <td valign=top style='border:solid #BBBBBB 1.0pt;mso-border-alt:solid #BBBBBB .25pt;
  background:#FCFEC5;padding:7.5pt 8.25pt .75pt 8.25pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><b style='mso-bidi-font-weight:normal'><span style='font-size:10.5pt;
  font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
  color:black;mso-no-proof:yes'><!--[if gte vml 1]><v:shape id="Picture_x0020_2"
   o:spid="_x0000_i1026" type="#_x0000_t75" alt="Description: Description: note"
   style='width:.75pt;height:.75pt;visibility:visible;mso-wrap-style:square'>
   <v:imagedata src="ExcelBFF_files/image001.gif" o:title=" note"/>
  </v:shape><![endif]--><![if !vml]><img border=0 width=1 height=1
  src="ExcelBFF_files/image001.gif" alt="Description: Description: note"
  v:shapes="Picture_x0020_2"><![endif]></span></b><b><span style='font-size:
  10.5pt;font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
  color:black'>Note: <o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td valign=top style='border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:
  solid #BBBBBB .25pt;mso-border-alt:solid #BBBBBB .25pt;background:#FCFEC5;
  padding:.75pt 8.25pt 7.5pt 8.25pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:
  0in;margin-left:.75pt;margin-bottom:.0001pt;line-height:140%'><span
  style='font-size:9.5pt;line-height:140%;font-family:"Segoe UI","sans-serif";
  mso-fareast-font-family:"Times New Roman";color:black'>The record
  descriptions in the <a
  href="http://msdn.microsoft.com/en-us/library/cc313154.aspx"><span
  style='font-family:"Times New Roman","serif"'>[MS-XLS]: Excel Binary File
  Format (.xls) Structure Specification</span></a> do not include mention of
  the Record Type (rt) and Count of Bytes (cb) values that make up the first
  four bytes of the record. For more information, see <a
  href="http://msdn.microsoft.com/en-us/library/dd943823.aspx"><span
  style='font-family:"Times New Roman","serif"'>section 2.1.4</span></a> of the
  MS-XLS specification.<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>These are the main
streams, substreams, and records in an MS-XLS format file. Specific byte
locations within a record are counted from the end of the cb field.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l0 level1 lfo6;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd911009.aspx"><span
style='font-family:"Times New Roman","serif"'>Workbook</span></a> stream<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>The <b>Workbook</b> stream is the primary stream in an .xls file.
It contains multiple substreams, each of which starts with a Beginning of File
(BOF) record and ends with an End of File (EOF) record. The first stream is
always the <b>Globals</b> substream, and the rest are <b>sheet</b> substreams.
These include worksheets, macro sheets, chart sheets, dialog sheets, and VBA
module sheets.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l0 level1 lfo6;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd952177.aspx"><span
style='font-family:"Times New Roman","serif"'>Globals</span></a> substream<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>The <b>Globals</b> substream specifies global properties and data
in a workbook. It also includes a <b>BoundSheet8</b> record for each substream
in the <b>Workbook</b> stream.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;text-indent:-.25in;line-height:normal;mso-list:l0 level2 lfo6;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd773237(office.12,robot).aspx"><span
style='font-family:"Times New Roman","serif"'>BoundSheet8</span></a> record<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>A <b>BoundSheet8</b> record gives information about a sheet
substream. This includes name, location, type, and visibility. The first 4
bytes of the record, the <b>lbPlyPos</b> FilePointer, specifies the position in
the <b>Workbook</b> stream where the sheet substream starts.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l0 level1 lfo6;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd953487.aspx"><span
style='font-family:"Times New Roman","serif"'>Worksheet</span></a> substream<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>The <b>Worksheet</b> substream specifies a sheet in a workbook.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;text-indent:-.25in;line-height:normal;mso-list:l0 level2 lfo6;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd910273.aspx"><span
style='font-family:"Times New Roman","serif"'>Cell Table</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>The cell table is the part of a sheet stream where cells are
stored. It contains a series of row blocks, each of which has a capacity of 32
rows of cells, and are filled sequentially. Each row block starts with a series
of <b>Row </b>records, followed by the cells that go in the rows, and ends with
a <a href="http://msdn.microsoft.com/en-us/library/dd926427.aspx"><span
style='font-family:"Times New Roman","serif"'>DBCell</span></a> record, which
gives the starting offset of the first cell of each row in the block.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;text-indent:-.25in;line-height:normal;mso-list:l0 level2 lfo6;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd906757.aspx"><span
style='font-family:"Times New Roman","serif"'>Row</span></a> record<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>A <b>Row</b> record defines a row in a sheet. This is a complex
structure, but only the first 6 bytes are needed for basic content retrieval.
These give the row index and the columns of the first cells and last cells that
contain data or unique formatting in the row.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;text-indent:-.25in;line-height:normal;mso-list:l0 level2 lfo6;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Cells<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>All of the cells in a row block are stored after the last row in
the block. There are seven kinds of records that represent actual cells in a
worksheet. Most cell records begin with a 6-byte <a
href="http://msdn.microsoft.com/en-us/library/dd908104.aspx"><span
style='font-family:"Times New Roman","serif"'>Cell</span></a> structure. The
first 2 of those bytes specify the row, the next 2 bytes specify the column,
and the last 2 bytes specify an <a
href="http://msdn.microsoft.com/en-us/library/dd949063.aspx"><span
style='font-family:"Times New Roman","serif"'>XF</span></a> record in the <b>Globals</b>
substream that contains formatting information.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>The following records represent the different kinds of cells.
Unless specified otherwise, the first 6 bytes are taken up by the cell
structure, and the remaining bytes contain the value.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;text-indent:-.25in;line-height:normal;mso-list:l0 level3 lfo6;
tab-stops:list 1.5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd906116.aspx"><span
style='font-family:"Times New Roman","serif"'>Blank</span></a> cell record<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>A <b>Blank</b> cell record specifies a blank cell that has no
formula or value. This record type is used only for cells that contain
individual formatting; otherwise, blank cells are stored in <b>MulBlank</b>
records or not at all.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;text-indent:-.25in;line-height:normal;mso-list:l0 level3 lfo6;
tab-stops:list 1.5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd907549.aspx"><span
style='font-family:"Times New Roman","serif"'>RK</span></a> cell record<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>An <b>RK</b> cell record contains a 32-bit number. Excel
automatically converts numbers that can be represented in 32 bits or less to
this format for storage as a way to reduce file size. Instead of a 6-byte cell
structure, the first 2 bytes specify the row and the second 2 bytes specify the
column. The remaining 6 bytes define the number in an <a
href="http://msdn.microsoft.com/en-us/library/dd951590.aspx"><span
style='font-family:"Times New Roman","serif"'>RkRec</span></a> structure for
disk and memory optimization.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;text-indent:-.25in;line-height:normal;mso-list:l0 level3 lfo6;
tab-stops:list 1.5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd910773.aspx"><span
style='font-family:"Times New Roman","serif"'>BoolErr</span></a> cell record<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>A BoolErr cell record contains a 2-byte <a
href="http://msdn.microsoft.com/en-us/library/dd906734.aspx"><span
style='font-family:"Times New Roman","serif"'>Bes</span></a> structure that may
be either a Boolean value or an error code.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;text-indent:-.25in;line-height:normal;mso-list:l0 level3 lfo6;
tab-stops:list 1.5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd950089.aspx"><span
style='font-family:"Times New Roman","serif"'>Number</span></a> cell record<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>A <b>Number</b> cell record contains a 64-bit floating-point
number.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;text-indent:-.25in;line-height:normal;mso-list:l0 level3 lfo6;
tab-stops:list 1.5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd945698.aspx"><span
style='font-family:"Times New Roman","serif"'>LabelSst</span></a> cell record<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>A <a href="http://msdn.microsoft.com/en-us/library/dd945698.aspx"><span
style='font-family:"Times New Roman","serif"'>LabelSst</span></a> cell record
contains a 4-byte integer that specifies a string in the Shared Strings Table
(SST). Specifically, the integer corresponds to the array index in the RGB
field of the SST.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;text-indent:-.25in;line-height:normal;mso-list:l0 level3 lfo6;
tab-stops:list 1.5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd908919.aspx"><span
style='font-family:"Times New Roman","serif"'>Formula</span></a> cell record<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>A <b>Formula</b> cell record contains both the formula and the resulting
data. The value displayed in the cell is defined in a <a
href="http://msdn.microsoft.com/en-us/library/dd945352.aspx"><span
style='font-family:"Times New Roman","serif"'>FormulaValue</span></a> structure
in the 8 bytes that follow the cell structure. The next 6 bytes can be ignored,
and the rest of the record is a <a
href="http://msdn.microsoft.com/en-us/library/dd908822.aspx"><span
style='font-family:"Times New Roman","serif"'>CellParsedFormula</span></a>
structure that contains the formula itself.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;text-indent:-.25in;line-height:normal;mso-list:l0 level3 lfo6;
tab-stops:list 1.5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd950649(office.12,robot).aspx"><span
style='font-family:"Times New Roman","serif"'>MulBlank</span></a> record<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>A <b>MulBlank</b> record specifies a series of blank cells in a
row.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>The first 2 bytes give the row, and the next 2 bytes give the
column that the series of blanks starts at. Next, a variable length array of <b>cell</b>
structures follows to store formatting information, and the last 2 bytes show
what column the series of blanks ends on.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;text-indent:-.25in;line-height:normal;mso-list:l0 level3 lfo6;
tab-stops:list 1.5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd952688.aspx"><span
style='font-family:"Times New Roman","serif"'>MulRK</span></a> record<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:1.25in;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>A <b>MulRk</b> record is like a <b>MulBlank</b> record, but
instead of blank cells, a <b>MulRk</b> record consists of <b>RK</b> data in <b>RkRec</b>
structures.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;text-indent:-.25in;line-height:normal;mso-list:l0 level2 lfo6;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/dd773037.aspx"><span
style='font-family:"Times New Roman","serif"'>Shared String Table (SST)</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:60.0pt;line-height:normal'><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:black'>The Shared String Table (SST) contains all of the string values in
the workbook. These values are referenced in the worksheet by <b>LabelSst</b>
cell records. The first 8 bytes of the SST give the number of references to
strings in the workbook and the number of unique string values in the SST. The
rest is an array of <a
href="http://msdn.microsoft.com/en-us/library/dd943830(office.12,robot).aspx"><span
style='font-family:"Times New Roman","serif"'>XLUnicodeRichExtendedString</span></a>
structures that contain the strings themselves as arrays of characters. Bit 16
of this structure specifies whether the characters are 1 byte or 2 bytes each.
You can extend both the <b>SST</b> structure and the <b>XLUnicodeRichExtendedString</b>
structure by using <a
href="http://msdn.microsoft.com/en-us/library/dd949081(office.12,robot).aspx"><span
style='font-family:"Times New Roman","serif"'>Continue</span></a> records if
the number or length of strings exceed their bounds.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
5.25pt;margin-left:0in;line-height:normal;mso-outline-level:4'><b><span
style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";mso-fareast-font-family:
"Times New Roman";color:#3F529C'>Extracting Data from Excel Files<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>All MS-XLS format file content
lives in the sheet substreams. Although you could load every sheet substream
indiscriminately, you gain more control and efficiency by using the <b>BoundSheet8</b>
records to locate just the sheets you want to read. Parsing of formulas and
formatting information is beyond the scope of this article. <o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>The following procedure
shows how to access all of the data from a worksheet.<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width="100%"
 style='width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid #BBBBBB .25pt;
 mso-yfti-tbllook:1184;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;height:15.75pt'>
  <td valign=top style='border:solid #BBBBBB 1.0pt;mso-border-alt:solid #BBBBBB .25pt;
  background:#FCFEC5;padding:7.5pt 8.25pt .75pt 8.25pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal'><b style='mso-bidi-font-weight:normal'><span style='font-size:10.5pt;
  font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
  color:black;mso-no-proof:yes'><!--[if gte vml 1]><v:shape id="Picture_x0020_1"
   o:spid="_x0000_i1025" type="#_x0000_t75" alt="Description: Description: note"
   style='width:.75pt;height:.75pt;visibility:visible;mso-wrap-style:square'>
   <v:imagedata src="ExcelBFF_files/image001.gif" o:title=" note"/>
  </v:shape><![endif]--><![if !vml]><img border=0 width=1 height=1
  src="ExcelBFF_files/image001.gif" alt="Description: Description: note"
  v:shapes="Picture_x0020_1"><![endif]></span></b><b><span style='font-size:
  10.5pt;font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
  color:black'>Note: <o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td valign=top style='border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:
  solid #BBBBBB .25pt;mso-border-alt:solid #BBBBBB .25pt;background:#FCFEC5;
  padding:.75pt 8.25pt 7.5pt 8.25pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:
  0in;margin-left:.75pt;margin-bottom:.0001pt;line-height:140%'><span
  style='font-size:9.5pt;line-height:140%;font-family:"Segoe UI","sans-serif";
  mso-fareast-font-family:"Times New Roman";color:black'>Specific byte
  locations within a record are counted from the end of the cb field.<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal;mso-outline-level:3'><b><span style='font-size:10.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Times New Roman";
color:#3F529C'>To read the content of an Excel worksheet<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.5in;text-indent:-.25in;line-height:normal;mso-list:l1 level1 lfo8;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Segoe UI";
color:black'><span style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Create an internal data
structure to hold the worksheet content.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.5in;text-indent:-.25in;line-height:normal;mso-list:l1 level1 lfo8;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Segoe UI";
color:black'><span style='mso-list:Ignore'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Define objects to
represent each of the eight cell record types in memory.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.5in;text-indent:-.25in;line-height:normal;mso-list:l1 level1 lfo8;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Segoe UI";
color:black'><span style='mso-list:Ignore'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Open the <b>Workbook</b>
stream and scan for the first instance of a <b>BOF</b> record. This is the
beginning of the <b>Globals</b> substream.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.5in;text-indent:-.25in;line-height:normal;mso-list:l1 level1 lfo8;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Segoe UI";
color:black'><span style='mso-list:Ignore'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Read the <b>Globals</b>
substream, loading the <b>BoundSheet8</b> records and the <b>SST</b> into
memory. For more details, see <a
href="http://msdn.microsoft.com/en-us/library/dd952177.aspx"><span
style='font-family:"Times New Roman","serif"'>Globals</span></a>.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.5in;text-indent:-.25in;line-height:normal;mso-list:l1 level1 lfo8;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Segoe UI";
color:black'><span style='mso-list:Ignore'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>From the <b>BoundSheet8</b>
record that corresponds to the substream you want to open, read the first 4
bytes, which contains the <b>lbPlyPos</b> FilePointer.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.5in;text-indent:-.25in;line-height:normal;mso-list:l1 level1 lfo8;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Segoe UI";
color:black'><span style='mso-list:Ignore'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Go to the offset in the
stream specified by the <b>lbPlyPos</b> FilePointer. This is the <b>BOF</b>
record for the worksheet.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.5in;text-indent:-.25in;line-height:normal;mso-list:l1 level1 lfo8;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Segoe UI";
color:black'><span style='mso-list:Ignore'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Read the next record in
the substream, which is the <a
href="http://msdn.microsoft.com/en-us/library/dd907627.aspx"><span
style='font-family:"Times New Roman","serif"'>Index</span></a> record, and load
the array of pointers that starts at byte 16 of the <b>Index</b> record. Each
pointer points to the stream position of a <b>DBCell</b> record.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.5in;text-indent:-.25in;line-height:normal;mso-list:l1 level1 lfo8;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:9.5pt;
font-family:"Segoe UI","sans-serif";mso-fareast-font-family:"Segoe UI";
color:black'><span style='mso-list:Ignore'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>For each pointer in the
array:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:66.0pt;text-indent:-.25in;line-height:normal;mso-list:l1 level2 lfo8;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Read the corresponding <b>DBCell</b>
record.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:66.0pt;text-indent:-.25in;line-height:normal;mso-list:l1 level2 lfo8;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Go to the offset
specified by the bytes 56 of the <b>DBCell</b> record and read into memory all
of the cell records, starting at that point and ending with the last byte
before the <b>DBCell</b>.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:66.0pt;text-indent:-.25in;line-height:normal;mso-list:l1 level2 lfo8;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Copy the cell records to
the objects that you defined in your internal data structure by record type.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:66.0pt;text-indent:-.25in;line-height:normal;mso-list:l1 level2 lfo8;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>Parse the cell data.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-outline-level:1'><b><span style='font-size:17.0pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:#3F529C;mso-font-kerning:18.0pt'>Example<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>The following code opens
an Excel workbook, reads each worksheet, and writes the content of that
worksheet to a text-based Comma Separated Value (.csv) file. A workbook with
content in multiple worksheets will produce multiple .csv files. This code is
for illustrative purposes only, and does not interpret formulas, non-worksheet
substreams, or Continue records.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>The first two sections,
Generic OLE Compound File functions and diagnostic functions, can be used with
any Word, Excel, or PowerPoint binary file, or other OLE compound file type.
The rest apply specifically to .xls files.<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>C++<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// Resources to include</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#include</span><span style='font-size:
9.5pt;font-family:Consolas'> <span style='color:#A31515'>&quot;stdafx.h&quot;</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#include</span><span style='font-size:
9.5pt;font-family:Consolas'> <span style='color:#A31515'>&lt;iostream&gt;</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#include</span><span style='font-size:
9.5pt;font-family:Consolas'> <span style='color:#A31515'>&lt;fstream&gt;</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#include</span><span style='font-size:
9.5pt;font-family:Consolas'> <span style='color:#A31515'>&lt;bitset&gt;</span> <o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>#include</span><span style='font-size:
9.5pt;font-family:Consolas'> <span style='color:#A31515'>&lt;sstream&gt;</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>using</span><span style='font-size:9.5pt;
font-family:Consolas'> <span style='color:blue'>namespace</span> std;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>////////////////////////////////////////</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// Generic OLE Compound File functions</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>IStorage* GetRoot(WCHAR fileName[]){<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>AfxOleInit();
<span style='color:green'>// Initialize OLE.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Verify that target is a compound file.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = StgIsStorageFile(fileName);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (hr) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>cout
&lt;&lt; fileName &lt;&lt; <span style='color:#A31515'>&quot; is not a valid
OLE compound document.\n&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>return</span> NULL;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Initialize IStorage pointer.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>IStorage*
pStgRoot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Last parameter assigns value to pStgRoot.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>hr =
::StgOpenStorage(fileName, NULL, STGM_READ | STGM_PRIORITY, NULL, 0,
&amp;pStgRoot);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> pStgRoot;<span style='mso-tab-count:2'>           </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>IStorage* GetSubStorage(IStorage* root, WCHAR
name[]) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Create pointer for sub storage.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>IStorage*
pSubStg;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Set pSubStg to the named sub storage.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = root-&gt;OpenStorage(name, 0, STGM_READ | STGM_PRIORITY, 0, 0,
&amp;pSubStg);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> pSubStg;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>IStream* GetStream(IStorage* pStor, LPOLESTR name)
{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Create stream pointer.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>IStream*
pStr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Set pStr to the named stream.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = pStor-&gt;OpenStream(name, 0, STGM_READ | STGM_SHARE_EXCLUSIVE, 0,
&amp;pStr);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> pStr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>UINT * GetUint(IStream* stream, UINT bytesToRead) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (bytesToRead % 4 != 0) <span style='color:blue'>throw</span>
<span style='color:#A31515'>&quot;Type/index mismatch.&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Create a buffer to read to.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>UINT *
buffer = <span style='color:blue'>new</span> UINT [bytesToRead / 4];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ULONG
bytesRead;<span style='mso-tab-count:1'>     </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Read the stream into buffer.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = stream-&gt;Read(buffer, (ULONG) bytesToRead, &amp;bytesRead);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>else</span> <span style='color:blue'>if</span> ( bytesRead
!= bytesToRead ) <span style='color:blue'>throw</span> <span style='color:#A31515'>&quot;End
of stream reached.\n&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Return the data as UINT[].</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> buffer;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>USHORT * GetUshort(IStream* stream, UINT
bytesToRead) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (bytesToRead % 2 != 0) <span style='color:blue'>throw</span>
<span style='color:#A31515'>&quot;Type/index mismatch.&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>USHORT
* buffer = <span style='color:blue'>new</span> USHORT [bytesToRead / 2];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ULONG
bytesRead;<span style='mso-tab-count:1'>     </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = stream-&gt;Read(buffer, (ULONG) bytesToRead, &amp;bytesRead);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>else</span> <span style='color:blue'>if</span> ( bytesRead
!= bytesToRead ) <span style='color:blue'>throw</span> <span style='color:#A31515'>&quot;End
of stream reached.\n&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> buffer;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>int</span><span style='font-size:9.5pt;
font-family:Consolas'> * GetInt(IStream* stream, UINT bytesToRead) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (bytesToRead % 4 != 0) <span style='color:blue'>throw</span>
<span style='color:#A31515'>&quot;Type/index mismatch.&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>int</span> * buffer = <span style='color:blue'>new</span> <span
style='color:blue'>int</span> [bytesToRead / 4];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ULONG
bytesRead;<span style='mso-tab-count:1'>     </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = stream-&gt;Read(buffer, (ULONG) bytesToRead, &amp;bytesRead);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>else</span> <span style='color:blue'>if</span> ( bytesRead
!= bytesToRead ) <span style='color:blue'>throw</span> <span style='color:#A31515'>&quot;End
of stream reached.\n&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> buffer;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>short</span><span style='font-size:9.5pt;
font-family:Consolas'> * GetShort(IStream* stream, UINT bytesToRead) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (bytesToRead % 2 != 0) <span style='color:blue'>throw</span>
<span style='color:#A31515'>&quot;Type/index mismatch.&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>short</span> * buffer = <span style='color:blue'>new</span> <span
style='color:blue'>short</span> [bytesToRead / 2];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ULONG
bytesRead;<span style='mso-tab-count:1'>     </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = stream-&gt;Read(buffer, (ULONG) bytesToRead, &amp;bytesRead);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>else</span> <span style='color:blue'>if</span> ( bytesRead
!= bytesToRead ) <span style='color:blue'>throw</span> <span style='color:#A31515'>&quot;End
of stream reached.\n&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> buffer;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>byte * GetByte(IStream* stream, UINT bytesToRead) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (bytesToRead % 1 != 0) <span style='color:blue'>throw</span>
<span style='color:#A31515'>&quot;Type/index mismatch.&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>byte *
buffer = <span style='color:blue'>new</span> byte [bytesToRead];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ULONG
bytesRead;<span style='mso-tab-count:1'>     </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = stream-&gt;Read(buffer, (ULONG) bytesToRead, &amp;bytesRead);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>else</span> <span style='color:blue'>if</span> ( bytesRead
!= bytesToRead ) <span style='color:blue'>throw</span> <span style='color:#A31515'>&quot;End
of stream reached.\n&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> buffer;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>float</span><span style='font-size:9.5pt;
font-family:Consolas'> * GetFloat(IStream* stream, UINT bytesToRead) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (bytesToRead % 4 != 0) <span style='color:blue'>throw</span>
<span style='color:#A31515'>&quot;Type/index mismatch.&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>float</span> * buffer = <span style='color:blue'>new</span> <span
style='color:blue'>float</span> [bytesToRead / 4];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ULONG
bytesRead = 0;<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = stream-&gt;Read(buffer, (ULONG) bytesToRead, &amp;bytesRead);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>else</span> <span style='color:blue'>if</span> ( bytesRead
!= bytesToRead ) <span style='color:blue'>throw</span> <span style='color:#A31515'>&quot;End
of stream reached.\n&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> buffer;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>double</span><span style='font-size:
9.5pt;font-family:Consolas'> * GetDouble(IStream* stream, UINT bytesToRead) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (bytesToRead % 8 != 0) <span style='color:blue'>throw</span>
<span style='color:#A31515'>&quot;Type/index mismatch.&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>double</span> * buffer = <span style='color:blue'>new</span>
<span style='color:blue'>double</span> [bytesToRead / 8];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ULONG
bytesRead = 0;<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = stream-&gt;Read(buffer, (ULONG) bytesToRead, &amp;bytesRead);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>else</span> <span style='color:blue'>if</span> ( bytesRead
!= bytesToRead ) <span style='color:blue'>throw</span> <span style='color:#A31515'>&quot;End
of stream reached.\n&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> buffer;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// Moves the stream pointer bytesToSkip
bytes and updates CurrentStreamPosition.</span><span style='font-size:9.5pt;
font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>ULONGLONG CurrentStreamPosition;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>void</span><span style='font-size:9.5pt;
font-family:Consolas'> Skip(IStream* stream, <span style='color:blue'>int</span>
bytesToSkip) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>LARGE_INTEGER
bts = {0};<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>bts.QuadPart
= bytesToSkip;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ULARGE_INTEGER
u;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = stream-&gt;Seek(bts, STREAM_SEEK_CUR, &amp;u);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>CurrentStreamPosition
= u.QuadPart;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// Moves the current pointer position
from the start of the stream.</span><span style='font-size:9.5pt;font-family:
Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>bool</span><span style='font-size:9.5pt;
font-family:Consolas'> EndOfSubStream = <span style='color:blue'>false</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>void</span><span style='font-size:9.5pt;
font-family:Consolas'> SkipFromStart(IStream* stream, UINT bytesToSkip) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>EndOfSubStream
= <span style='color:blue'>false</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>LARGE_INTEGER
bts = {bytesToSkip};<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>HRESULT
hr = stream-&gt;Seek(bts, STREAM_SEEK_SET, NULL);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( FAILED(hr) ) <span style='color:blue'>throw</span>
hr;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>////////////////////////////////////////////////////////////////</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// Diagnostic functions for checking
binary data</span><span style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// Shows a bit diagram of byte b.</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>void</span><span style='font-size:9.5pt;
font-family:Consolas'> BitsOut(byte b) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>bitset&lt;8&gt;
bs = b;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>for</span> (<span style='color:blue'>int</span> i=0; i&lt;8;
i++) cout &lt;&lt; bs[i];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// Shows a bit diagram of UINT u.</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>void</span><span style='font-size:9.5pt;
font-family:Consolas'> BitsOut(UINT u) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>byte* b
= (byte*) &amp;u;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>for</span> (<span style='color:blue'>int</span> i=0; i&lt;4;
i++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>BitsOut(*(b
+ i));<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>cout
&lt;&lt; <span style='color:#A31515'>&quot;|&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>cout
&lt;&lt; endl;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>///////////////////////////////////////////////////////////</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// MS-XLS constants</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// MS-XLS Record type constants</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_BOF = 2057;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_BOUNDSHEET8 = 133;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_WSBOOL = 129;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_SST = 252;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_ROW = 520;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_BLANK = 513;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_MULBLANK = 190;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_RK = 638;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_MULRK = 189;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_NUMBER = 515;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_FORMULA = 6;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_BOOLERR = 517;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_LABELSST = 253;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT RT_EOF = 10;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// Other MS-XLS constants</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>const</span><span style='font-size:9.5pt;
font-family:Consolas'> USHORT MAX_CELLS = 256;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>////////////////////////////////////////////////////////////////</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// MS-XLS utility functions</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>/* Checks the current pointer position
for the specified record type,</span><span style='font-size:9.5pt;font-family:
Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>if matched, returns the length of the
record; otherwise returns 0 and</span><span style='font-size:9.5pt;font-family:
Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>moves the pointer to the end of the
record.*/</span><span style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>bool</span><span style='font-size:9.5pt;
font-family:Consolas'> EmptyRecord = <span style='color:blue'>false</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>long</span><span style='font-size:9.5pt;
font-family:Consolas'> GetNext( IStream* stream, UINT rtWanted ) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Read the record type of the current record.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>USHORT
rtFound = * GetUshort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (rtFound == RT_EOF) EndOfSubStream = <span
style='color:blue'>true</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Get the length of the current record.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>USHORT
length = * GetUshort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// If it's the right record, return the length; </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// otherwise, skip to the next one.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> ( rtFound == rtWanted ) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (length == 0) EmptyRecord = <span
style='color:blue'>true</span>;<span style='mso-tab-count:1'>     </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>return</span> length;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>else</span> {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (length != 0) Skip(stream, length);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>return</span> 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>/* Finds the next record of type
rtWanted, sets the current pointer </span><span style='font-size:9.5pt;
font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'><span
style='mso-spacerun:yes'> </span>to the beginning of the record data, and
returns the size of that data.</span><span style='font-size:9.5pt;font-family:
Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'><span
style='mso-spacerun:yes'> </span>Must be called from the beginning of a record
header. */</span><span style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>long</span><span style='font-size:9.5pt;
font-family:Consolas'> FindRecord( IStream* stream, UINT rtWanted ) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (EndOfSubStream) <span style='color:blue'>return</span>
0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>USHORT
length = 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>while</span> (length == 0 &amp;&amp; !EmptyRecord &amp;&amp;
!EndOfSubStream) length = GetNext(stream, rtWanted);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> length;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>///////////////////////////////////////////////////////////////////</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// Functions to interpret MS-XLS
content</span><span style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>/* Reads the shared string table into
the SST array */</span><span style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>wstring * SST;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>void</span><span style='font-size:9.5pt;
font-family:Consolas'> ReadSST(IStream* stream) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>Skip(stream,
4);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>int</span> numStrings = * GetInt(stream, 4);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>SST = <span
style='color:blue'>new</span> wstring [numStrings];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>USHORT
countChars;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>WCHAR *
chars;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>byte *
bytes;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>USHORT
j, k;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>for</span> (<span style='color:blue'>int</span> i=0;
i&lt;numStrings; i++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>countChars
= * GetUshort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:green'>// Read bit flags.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>bitset&lt;8&gt;
b = *(GetByte(stream, 1));<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>bool</span> fHighByte = b[0];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>bool</span> fExtSt = b[2];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>bool</span> fRichSt = b[3];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>int</span> cbExtRst;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>short</span> cRun;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:green'>// Check optional fields.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (fRichSt) cRun = * GetShort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (fExtSt) cbExtRst = * GetInt(stream, 4);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:green'>// Load the string.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>chars
= <span style='color:blue'>new</span> WCHAR [countChars];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> ( fHighByte ) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>bytes
= GetByte(stream, countChars);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>for</span> (j=0; j&lt;countChars; j++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>for</span> (k=0; k&lt;countChars * 2; k+=2) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:5'>                                  </span>chars[j]
= (<span style='color:blue'>char</span>) (bytes[k], bytes[k+1]);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:5'>                                  </span>SST[i]
+= chars[j];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>}<span
style='mso-tab-count:2'>             </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>else</span> {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>bytes
= GetByte(stream, countChars);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>for</span> (j=0; j&lt;countChars; j++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>chars[j]
= (WCHAR) *(bytes + j);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>SST[i]
+= chars[j];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:green'>// Skip otional arrays if present.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (fRichSt) Skip(stream, cRun * 4);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (fExtSt) Skip(stream, cbExtRst);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>SST[i]
+= L<span style='color:#A31515'>&quot;\0&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>delete</span> (chars);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>/* Checks the WsBool record to see if
the current sheet is a dialog sheet. */</span><span style='font-size:9.5pt;
font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>bool</span><span style='font-size:9.5pt;
font-family:Consolas'> isDialogSheet(IStream* stream, <span style='color:blue'>long</span>
len) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>bitset&lt;8&gt;
b = * GetByte(stream, 1);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>Skip(stream,
len - 1); <span style='color:green'>// Always exit at the end of a record.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> (<span style='color:blue'>bool</span>) b[4];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>int</span><span style='font-size:9.5pt;
font-family:Consolas'> MaxRow;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>int</span><span style='font-size:9.5pt;
font-family:Consolas'> NumRows;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>void</span><span style='font-size:9.5pt;
font-family:Consolas'> GetNumRows(IStream* stream) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>MaxRow
= 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>NumRows
= 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>long</span> len = FindRecord(stream, RT_ROW);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (EndOfSubStream) <span style='color:blue'>return</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>Skip(stream,
-2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>USHORT
rw = 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>UINT rt
= RT_ROW;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>while</span> (rt == RT_ROW) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>NumRows
++;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>Skip(stream,
2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>rw
= *GetUshort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (rw &gt; MaxRow) MaxRow = rw;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>Skip(stream,
14);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>rt
= *GetUshort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>Skip(stream,
-2); <span style='color:green'>// Back up to the end of the last row.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>wstring ReadRk(IStream* stream) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>wstringstream
wss;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>Skip(stream,
2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>UINT u
= *GetUint(stream, 4);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Read the left 2 bits as flags, then clear them.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>byte b
= *(byte*) &amp;u;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>bool</span> fX100 = b &amp; (byte) 1;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>bool</span> fInt = b &amp; (byte) 2;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>u
&gt;&gt;= 2; <o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>u
&lt;&lt;= 2;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (fInt) {<span style='mso-tab-count:5'>                              </span><span
style='color:green'>// Read as int.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>int</span> i = *(<span style='color:blue'>int</span>*)
(&amp;u);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (fX100) i = i / 100;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>wss
&lt;&lt; i;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>else</span> {<span style='mso-tab-count:6'>                                   </span><span
style='color:green'>// Read as double.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>UINT
u2 [2] = {0, u};<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>double</span> d = *(<span style='color:blue'>double</span>*)
(&amp;u2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (fX100) d = d / 100;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>wss
&lt;&lt; d;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Return value as wide string.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> wss.str();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>wstring ReadSheet(IStream* stream) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Build the worksheet grid.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>wstring**
worksheet;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>worksheet
= <span style='color:blue'>new</span> wstring* [MaxRow + 1];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>for</span> (<span style='color:blue'>int</span> i=0;
i&lt;=MaxRow; i++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>worksheet[i]
= <span style='color:blue'>new</span> wstring[MAX_CELLS];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Fill in the cells.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>bool</span> done = <span style='color:blue'>false</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>USHORT
maxCol = 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>while</span> (!done) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>USHORT
rt = * GetUshort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>USHORT
len = * GetUshort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>USHORT
rw = * GetUshort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>USHORT
col = * GetUshort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (col &gt; maxCol) maxCol = col;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>byte*
bes;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>bool</span> fError;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>UINT
rgb;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>wstring
s;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>double</span> d;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>wstringstream
wss;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>switch</span> (rt) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>case</span> RT_BLANK:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>Skip(stream,
2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>worksheet
[rw] [col] = L<span style='color:#A31515'>&quot;&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>break</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>case</span> RT_BOOLERR:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>Skip(stream,
2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>bes
= GetByte(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>fError
= (<span style='color:blue'>bool</span>) bes[1];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>if</span> (fError) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>switch</span> (bes[0]) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>case</span> 0:<span style='mso-tab-count:2'>              </span>s
= L<span style='color:#A31515'>&quot;#NULL!&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>case</span> 0x07:<span style='mso-tab-count:1'>    </span>s
= L<span style='color:#A31515'>&quot;#DIV/0!&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>case</span> 0x0F:<span style='mso-tab-count:1'>    </span>s
= L<span style='color:#A31515'>&quot;#VALUE!&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>case</span> 0x17:<span style='mso-tab-count:1'>    </span>s
= L<span style='color:#A31515'>&quot;#REF!&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>case</span> 0x1D:<span style='mso-tab-count:1'>    </span>s
= L<span style='color:#A31515'>&quot;#NAME?&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>case</span> 0x24:<span style='mso-tab-count:1'>    </span>s
= L<span style='color:#A31515'>&quot;#NUM!&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>case</span> 0x2A:<span style='mso-tab-count:1'>    </span>s
= L<span style='color:#A31515'>&quot;#N/A&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>case</span> 0x2B:<span style='mso-tab-count:1'>    </span>s
= L<span style='color:#A31515'>&quot;#GETTING_DATA&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>else</span> {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>bool</span> b = (<span style='color:blue'>bool</span>)
bes[0];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>s
= b? L<span style='color:#A31515'>&quot;TRUE&quot;</span> : L<span
style='color:#A31515'>&quot;FALSE&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>worksheet
[rw] [col] = s;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>break</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>case</span> RT_LABELSST:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>Skip(stream,
2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>rgb
= * GetUint(stream, 4);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>worksheet
[rw] [col] = SST[rgb];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>break</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>case</span> RT_RK:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>s
= ReadRk(stream);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>worksheet
[rw] [col] = s;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>break</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='mso-tab-count:1'>       </span><span style='color:blue'>case</span>
RT_MULRK:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>for</span> (<span style='color:blue'>short</span> i=0;
i&lt;(len - 6) / 6; i++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>s
= ReadRk(stream);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>worksheet
[rw] [col] = s;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>col
++;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>if</span> (maxCol &lt; col) maxCol ++;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>Skip(stream,
2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>break</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>case</span> RT_MULBLANK:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>for</span> (<span style='color:blue'>short</span> i=0;
i&lt;(len - 6) / 2; i++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>Skip(stream,
2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>worksheet
[rw] [col] = L<span style='color:#A31515'>&quot;&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span>col
++;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:4'>                           </span><span
style='color:blue'>if</span> (maxCol &lt; col) maxCol ++;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>Skip(stream,
2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>break</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>case</span> RT_NUMBER:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>Skip(stream,
2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>d
= * GetDouble(stream, 8);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>wss
&lt;&lt; d;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>worksheet
[rw] [col] = wss.str();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>break</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>case</span> RT_FORMULA:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>Skip(stream,
len - 4);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>worksheet
[rw] [col] = L<span style='color:#A31515'>&quot;[formula]&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>break</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>default</span>:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>done
= <span style='color:blue'>true</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Convert the worksheet to a wstring.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>wstring
sheet;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>for</span> (USHORT i=0; i&lt;=MaxRow; i++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>for</span> (USHORT j=0; j&lt;= maxCol; j++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>sheet
+= worksheet [i] [j];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>j
&lt; maxCol ? sheet += L<span style='color:#A31515'>'\t'</span> : sheet += <span
style='color:#A31515'>'\n'</span>; <span style='color:green'>// or use
&quot;\t&quot; instead of &quot;,&quot;</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>delete</span> (worksheet);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> sheet;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// For simplicity, this writes ANSII
strings to a text file</span><span style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// instead of preserving Unicode.</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>int</span><span style='font-size:9.5pt;
font-family:Consolas'> WriteCSV(wstring sheet, string fileName, USHORT
sheetNum) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>stringstream
ss;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ss
&lt;&lt; fileName &lt;&lt; sheetNum &lt;&lt; <span style='color:#A31515'>&quot;.csv&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>string
s = ss.str();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>string
s2;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>s2.assign(sheet.begin(),
sheet.end());<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>wcout
&lt;&lt; sheet;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ofstream
outFile;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>outFile.open
(s);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>outFile
&lt;&lt; s2;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>outFile.close
();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>void</span><span style='font-size:9.5pt;
font-family:Consolas'> ParseTheFile(IStorage* root, wstring fileName) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Get a pointer to the Workbook stream.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>wstring
ws = L<span style='color:#A31515'>&quot;Workbook&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>LPOLESTR
name = W2OLE((<span style='color:blue'>wchar_t</span>*)ws.c_str());<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>IStream*
stream = GetStream(root, name);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Get the number of sheet substreams.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>USHORT
sheetNum = 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>long</span> lBS8 = FindRecord(stream, RT_BOUNDSHEET8);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>while</span> (lBS8 != 0) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>Skip(stream,
lBS8);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>lBS8
= GetNext(stream, RT_BOUNDSHEET8);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>sheetNum
++;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Get the locations and types of the sheet substreams.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>UINT *
location = <span style='color:blue'>new</span> UINT [sheetNum];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>bool</span> * isworksheet = <span style='color:blue'>new</span>
<span style='color:blue'>bool</span> [sheetNum];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>SkipFromStart(stream,
0);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>lBS8 =
FindRecord(stream, RT_BOUNDSHEET8);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>for</span> (USHORT i=0; i &lt; sheetNum; i++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>location[i]
= * GetUint(stream, 4);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>Skip(stream,
1);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>byte
b = * GetByte(stream, 1);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>isworksheet[i]
= (b == 0) ? <span style='color:blue'>true</span> : <span style='color:blue'>false</span>
;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>Skip(stream,
lBS8 - 4);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>lBS8
= * GetShort(stream, 2);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Get the shared string table.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>long</span> sstLength = FindRecord(stream, RT_SST);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ReadSST(stream);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Read the sheets, and write the content to CSV files.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>wstring
sheet;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>string
outFileName;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>outFileName.assign(fileName.begin(),
fileName.end());<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>NumRows
= 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>long</span> len = 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>for</span> (<span style='color:blue'>short</span> i=0; i&lt;sheetNum;
i++) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:green'>// Instead of iterating through the remaining records to
seek the BOF</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:green'>// for the next substream, get better performance by
resetting the pointer.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>if</span> (isworksheet[i]) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>SkipFromStart(stream,
location[i]);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>len
= FindRecord(stream, RT_WSBOOL);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>if</span> (isDialogSheet(stream, len)) <span
style='color:blue'>continue</span>; <span style='color:green'>// Skip dialog
sheets.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>GetNumRows(stream);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span><span
style='color:blue'>if</span> (NumRows == 0) <span style='color:blue'>continue</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>sheet
= ReadSheet(stream);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:3'>                     </span>WriteCSV(sheet,
outFileName, i);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>///////////////////////////////////////////////////////////</span><span
style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:green'>// Generic wmain function for parsing
OLE compound files.</span><span style='font-size:9.5pt;font-family:Consolas'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas;color:blue'>int</span><span style='font-size:9.5pt;
font-family:Consolas'> wmain(<span style='color:blue'>int</span> argc, WCHAR
*argv[])<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (argc &gt; 2) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>cout
&lt;&lt; <span style='color:#A31515'>&quot;You must enter a valid file
name.\n&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>return</span> 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>wstring
fileName = (wstring) argv [1];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ifstream
i(argv[1]);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (!i) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span>wcout
&lt;&lt; fileName &lt;&lt; <span style='color:#A31515'>&quot; not
found.\n&quot;</span>;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:2'>              </span><span
style='color:blue'>return</span> 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>i.close();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Get a pointer to the root storage of the file.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>IStorage*
root = GetRoot(argv[1]);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Do specific file format operations here.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span>ParseTheFile(root,
fileName);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:green'>// Release resources and exit the program.</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>if</span> (root) root-&gt;Release();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><span style='mso-tab-count:1'>       </span><span
style='color:blue'>return</span> 0;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-layout-grid-align:none;text-autospace:none'><span style='font-size:
9.5pt;font-family:Consolas'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-outline-level:1'><b><span style='font-size:17.0pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:#3F529C;mso-font-kerning:18.0pt'>Conclusion<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>This is just a sampling
of the MS-XLS file format. By using the tools that are provided in this article,
simple data recovery should be within your reach. With additional exploration,
you can start to recover formulas, formatting information, and other metadata.
And eventually, even save operations become possible.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;mso-outline-level:1'><b><span style='font-size:17.0pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:#3F529C;mso-font-kerning:18.0pt'>Additional
Resources<o:p></o:p></span></b></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
line-height:normal'><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'>For more information,
see the following resources:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l4 level1 lfo10;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/cc313154.aspx"><span
style='font-family:"Times New Roman","serif"'>[MS-XLS]: Excel Binary File
Format (.xls) Structure Specification</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l4 level1 lfo10;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/openspecifications/dd569930"><span
style='font-family:"Times New Roman","serif"'>Open Specifications Developer
Center</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l4 level1 lfo10;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/hh965733.aspx"><span
style='font-family:"Times New Roman","serif"'>Parsing Formulas in a Binary
Excel .xls File</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l4 level1 lfo10;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg985447.aspx"><span
style='font-family:"Times New Roman","serif"'>Understanding Graphics in Office
Binary File Formats</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l4 level1 lfo10;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615407.aspx"><span
style='font-family:"Times New Roman","serif"'>Understanding Office Binary File
Formats</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l4 level1 lfo10;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615595.aspx"><span
style='font-family:"Times New Roman","serif"'>Understanding the Outlook MS-PST
Binary File Format</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l4 level1 lfo10;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615594.aspx"><span
style='font-family:"Times New Roman","serif"'>Understanding the PowerPoint
MS-PPT Binary File Format</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l4 level1 lfo10;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://msdn.microsoft.com/en-us/library/gg615596.aspx"><span
style='font-family:"Times New Roman","serif"'>Understanding the Word .doc
Binary File Format</span></a><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:9.75pt;margin-right:0in;margin-bottom:
9.75pt;margin-left:30.0pt;text-indent:-.25in;line-height:normal;mso-list:l4 level1 lfo10;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family:Symbol;
mso-bidi-font-family:Symbol;color:black'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-size:9.5pt;font-family:"Segoe UI","sans-serif";
mso-fareast-font-family:"Times New Roman";color:black'><a
href="http://download.microsoft.com/download/1/2/7/127BA59A-4FE1-4ACD-BA47-513CEEF85A85/OffVis.zip"><span
style='font-family:"Times New Roman","serif"'>Office Visualizer Tool</span></a><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
